<Window x:Class="MoneyFlowWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="💰 Финансовый Ассистент" 
        Height="700" 
        Width="1157"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Шапка приложения -->
        <Border Grid.Row="0" 
                Background="#2E7D32" 
                Padding="15">
            <StackPanel>
                <TextBlock Text="Финансовый Ассистент" 
                           Foreground="White"
                           FontSize="28"
                           FontWeight="Bold"
                           HorizontalAlignment="Center"/>

                <TextBlock Text="Учет доходов и расходов" 
                           Foreground="White"
                           FontSize="16"
                           HorizontalAlignment="Center"
                           Margin="0,5,0,0"/>
            </StackPanel>
        </Border>

        <!-- Основное содержимое -->
        <Grid Grid.Row="1" Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>

            <!-- Левая часть: Список операций -->
            <Border Grid.Column="0" 
                    Background="White" 
                    CornerRadius="8"
                    Padding="10"
                    Margin="0,0,5,0">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Панель управления таблицей -->
                    <StackPanel Grid.Row="0" 
                                Orientation="Horizontal"
                                Margin="0,0,0,10">
                        <Button x:Name="AddButton" 
                                Content="➕ Добавить" 
                                Width="120" 
                                Height="35" 
                                Margin="0,0,10,0"
                                Background="#4CAF50"
                                Foreground="White"
                                FontWeight="Bold"/>

                        <Button x:Name="RefreshButton" 
                                Content="🔄 Обновить" 
                                Width="120" 
                                Height="35"
                                Margin="0,0,10,0"
                                Background="#2196F3"
                                Foreground="White"
                                FontWeight="Bold"/>
                        <Button Content="❓ Помощь" 
                                Width="120" 
                                Height="35"
                                Background="#795548"
                                Foreground="White"
                                FontWeight="Bold"
                                Click="HelpButton_Click"/>

                        <TextBlock x:Name="StatusText"
                                   Text="Готово к работе"
                                   VerticalAlignment="Center"
                                   Margin="10,0,0,0"
                                   FontSize="14"/>

                    </StackPanel>

                    <!-- Таблица операций -->
                    <DataGrid x:Name="TransactionsGrid"
                              Grid.Row="1"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              SelectionMode="Single"
                              GridLinesVisibility="None"
                              RowBackground="#FFFFFF"
                              AlternatingRowBackground="#F8F9FA"
                              HeadersVisibility="Column"
                              BorderBrush="#E0E0E0"
                              BorderThickness="1"
                              CanUserSortColumns="True">

                        <DataGrid.Columns>
                            <!-- Дата -->
                            <DataGridTextColumn Header="Дата" 
                                                Binding="{Binding Date, StringFormat=dd.MM.yyyy HH:mm}"
                                                Width="120"
                                                IsReadOnly="True"
                                                CanUserSort="True"/>

                            <!-- Описание -->
                            <DataGridTextColumn Header="Описание" 
                                                Binding="{Binding Description}"
                                                Width="250"
                                                IsReadOnly="True"/>

                            <!-- Категория -->
                            <DataGridTextColumn Header="Категория" 
                                                Binding="{Binding Category}"
                                                Width="120"
                                                IsReadOnly="True"
                                                CanUserSort="True"/>

                            <!-- Сумма -->
                            <DataGridTextColumn Header="Сумма" 
                                                Binding="{Binding Amount, StringFormat={}{0} ₽}"
                                                Width="100"
                                                IsReadOnly="True"
                                                CanUserSort="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsIncome}" Value="True">
                                                <Setter Property="Foreground" Value="Green"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding IsIncome}" Value="False">
                                                <Setter Property="Foreground" Value="Red"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <!-- Тип операции (упрощенный) -->
                            <DataGridTextColumn Header="Тип" 
                                                Width="80"
                                                IsReadOnly="True"
                                                CanUserSort="True"
                                                SortMemberPath="IsIncome">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Text" Value="{Binding IsIncome}"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsIncome}" Value="True">
                                                <Setter Property="Text" Value="Доход"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding IsIncome}" Value="False">
                                                <Setter Property="Text" Value="Расход"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <!-- Действия -->
                            <DataGridTemplateColumn Header="Действия" Width="100">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Button Content="✏️" 
                        Width="30" 
                        Height="30"
                        Margin="2"
                        ToolTip="Редактировать"
                        Tag="{Binding Id}"
                        Click="EditButton_Click"/>

                                            <Button Content="🗑️" 
                        Width="30" 
                        Height="30"
                        Margin="2"
                        Background="#FF5252"
                        Foreground="White"
                        ToolTip="Удалить"
                        Tag="{Binding Id}"
                        Click="DeleteButton_Click"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>

                    </DataGrid>
                </Grid>
            </Border>

            <!-- Правая часть: Статистика -->
            <Border Grid.Column="1" 
                    Background="White" 
                    CornerRadius="8"
                    Padding="15"
                    Margin="5,0,0,0">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Заголовок статистики -->
                    <TextBlock Text="📊 Статистика" 
                               FontSize="20"
                               FontWeight="Bold"
                               Margin="0,0,0,15"/>

                    <!-- Цифровая статистика -->
                    <StackPanel Grid.Row="1">

                        <!-- Доходы -->
                        <Border Background="#E8F5E9" 
                                CornerRadius="5" 
                                Padding="10"
                                Margin="0,0,0,10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="Доходы" 
                                           FontSize="14"
                                           Foreground="#2E7D32"/>

                                <TextBlock x:Name="IncomeText"
                                           Text="0 ₽"
                                           Grid.Column="1"
                                           FontSize="16"
                                           FontWeight="Bold"
                                           Foreground="#2E7D32"/>
                            </Grid>
                        </Border>

                        <!-- Расходы -->
                        <Border Background="#FFEBEE" 
                                CornerRadius="5" 
                                Padding="10"
                                Margin="0,0,0,10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="Расходы" 
                                           FontSize="14"
                                           Foreground="#C62828"/>

                                <TextBlock x:Name="ExpenseText"
                                           Text="0 ₽"
                                           Grid.Column="1"
                                           FontSize="16"
                                           FontWeight="Bold"
                                           Foreground="#C62828"/>
                            </Grid>
                        </Border>

                        <!-- Баланс -->
                        <Border Background="#E3F2FD" 
                                CornerRadius="5" 
                                Padding="10"
                                Margin="0,0,0,10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="Баланс" 
                                           FontSize="14"
                                           Foreground="#1565C0"/>

                                <TextBlock x:Name="BalanceText"
                                           Text="0 ₽"
                                           Grid.Column="1"
                                           FontSize="18"
                                           FontWeight="Bold"
                                           Foreground="#1565C0"/>
                            </Grid>
                        </Border>

                        <!-- Счетчик операций -->
                        <Border Background="#FFF3E0" 
                                CornerRadius="5" 
                                Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="Всего операций" 
                                           FontSize="14"
                                           Foreground="#EF6C00"/>

                                <TextBlock x:Name="CountText"
                                           Text="0"
                                           Grid.Column="1"
                                           FontSize="16"
                                           FontWeight="Bold"
                                           Foreground="#EF6C00"/>
                            </Grid>
                        </Border>
                    </StackPanel>

                    <!-- Кнопки быстрых действий -->
                    <StackPanel Grid.Row="2" 
                                VerticalAlignment="Bottom"
                                Margin="0,20,0,0">

                        <Button Content="📤 Экспорт в Excel" 
                                Height="40"
                                Background="#F57C00"
                                Foreground="White"
                                FontWeight="Bold"
                                Margin="0,0,0,10"
                                Click="ExportToExcel_Click"/>

                        <Button Content="📁 Импорт выписки (PDF/CSV)" 
                                Height="40"
                                Background="#673AB7"
                                Foreground="White"
                                FontWeight="Bold"
                                Margin="0,0,0,10"
                                Click="ImportButton_Click"/>

                        <Button Content="📊 Графики и отчеты" 
                                Height="40"
                                Background="#009688"
                                Foreground="White"
                                FontWeight="Bold"
                                Margin="0,0,0,10"
                                Click="ChartsButton_Click"/>

                        <Button Content="⚙️ Настройки категорий" 
                                Height="40"
                                Background="#607D8B"
                                Foreground="White"
                                FontWeight="Bold"
                                Click="CategoriesButton_Click"/>
                        
                    </StackPanel>

                </Grid>
            </Border>

        </Grid>

        <!-- Нижний статус-бар -->
        <Border Grid.Row="2" 
                Background="#424242" 
                Padding="10">
            <TextBlock x:Name="FooterText"
                       Text="💰 Финансовый Ассистент | База данных загружена"
                       Foreground="White"
                       HorizontalAlignment="Center"/>
        </Border>

    </Grid>

</Window>